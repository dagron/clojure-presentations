desc "build the slideshow"

task :slideshow do
  sh "slideshow -v -o build clojure-for-ruby-programmers.maruku"
  sh "slideshow -v -o build clojure-concurrency.maruku"
end

task :cleanup_hack do
  %w{clojure-for-ruby-programmers clojure-concurrency}.each do |pres|
    File.open("build/tmp.html", "w") do |outfile|
      File.new("build/#{pres}.html").each_line do |line|
        outfile << line.gsub(/^&lt;code(.*)&gt;\s*$/, '<code\1>')
      end	
    end	
    rm "build/#{pres}.html"
    mv "build/tmp.html", "build/#{pres}.html"
  end
end

task :images do
  mkdir_p "build/images"
  FileList['images/*.jpg'].each do |img|
    cp img, "build/images"
  end
end

task :default => [:slideshow, :cleanup_hack, :images]

